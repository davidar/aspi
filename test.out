>>> % PICK UP A BIG RED BLOCK.
>>> goal_once$holding(big red block).
--> goal_once(holding(A)) :- big(A), red(A), block(A).
apply(pickup(green_cube_1),1).
apply(put_on(green_cube_1,box),2).
plan_interval(1,1,3).
apply(pickup(big_red),3).
moves(3).
ok.

>>> 
>>> % GRASP THE PYRAMID.
>>> goal_once$holding(that pyramid).
--> goal_once(holding(A)) :- that(A), pyramid(A).
I CAN'T

>>> 
>>> % FIND A BLOCK WHICH IS TALLER THAN THE ONE YOU ARE HOLDING AND PUT IT INTO THE BOX.
>>> block tall.holding?
--> show(B) :- block(B), tall(B,A), holding(A).
blue_block.

>>> goal_once$on(that, box).
--> goal_once(on(A,B)) :- that(A), box(B).
apply(put_on(big_red,table_front_right),4).
apply(pickup(blue_pyramid),5).
apply(put_on(blue_pyramid,big_red),6).
apply(pickup(blue_block),7).
plan_interval(3,4,8).
apply(put_on(blue_block,box),8).
moves(8).
ok.

>>> 
>>> goal_once$on(blue pyramid, box).
--> goal_once(on(A,B)) :- blue(A), pyramid(A), box(B).
apply(pickup(blue_block),9).
apply(put_on(blue_block,green_cube_1),10).
apply(pickup(blue_pyramid),11).
plan_interval(4,9,12).
apply(put_on(blue_pyramid,box),12).
moves(12).
ok.

>>> 
>>> % WHAT DOES THE BOX CONTAIN?
>>> above.box?
--> show(B) :- above(B,A), box(A).
blue_pyramid.
blue_block.
green_cube_1.

>>> 
>>> % WHAT IS THE PYRAMID SUPPORTED BY?
>>> supports[that pyramid]?
--> show(B) :- supports(B,A), that(A), pyramid(A).
box.

>>> 
>>> % HOW MANY BLOCKS ARE NOT IN THE BOX?
>>> block ~above.box?
--> show(C) :- block(C), not lifted1(C).
    lifted1(B) :- above(B,A), box(A).
big_red.
red_cube.
green_cube_2.

>>> 
>>> % IS AT LEAST ONE OF THEM NARROWER THAN THE ONE WHICH I TOLD YOU TO PICK UP?
>>> that narrow.history$goal$holding?
--> show(B) :- that(B), narrow(B,A), history(goal(holding(A))).
red_cube.

>>> 
>>> % IS IT SUPPORTED?
>>> supports.that?
--> show(B) :- supports(B,A), that(A).
table_front_left.

>>> 
>>> % CAN THE TABLE PICK UP BLOCKS?
>>> #any(table action$pickup.block)?
--> show(C) :- any1(C).
    any1(true) :- table(B), action(pickup(B,A)), block(A).
    any1(false) :- not any1(true).
false.

>>> 
>>> % CAN A PYRAMID BE SUPPORTED BY A BLOCK?
>>> #any(pyramid action$put_on.block)?
--> show(C) :- any1(C).
    any1(true) :- pyramid(B), action(put_on(B,A)), block(A).
    any1(false) :- not any1(true).
true.

>>> 
>>> % CAN A PYRAMID SUPPORT A PYRAMID?
>>> #any(pyramid action$put_on.pyramid)?
--> show(C) :- any1(C).
    any1(true) :- pyramid(B), action(put_on(B,A)), pyramid(A).
    any1(false) :- not any1(true).
false.

>>> 
>>> % STACK UP TWO PYRAMIDS.
>>> goal_once$on(pyramid, pyramid).
--> goal_once(on(A,B)) :- pyramid(A), pyramid(B).
I CAN'T

>>> 
>>> % WILL YOU PLEASE STACK UP BOTH OF THE RED BLOCKS AND EITHER A GREEN CUBE OR A PYRAMID?
>>> goal_once$stack(red block, red block, green cube | pyramid).
--> goal_once(stack(A,B,D)) :- red(A), block(A), red(B), block(B), disjunction1(D).
    disjunction1(C) :- green(C), cube(C).
    disjunction1(C) :- pyramid(C).
apply(pickup(green_pyramid),13).
apply(put_on(green_pyramid,big_red),14).
apply(pickup(red_cube),15).
apply(put_on(red_cube,big_red),16).
apply(pickup(red_pyramid),17).
plan_interval(13,13,18).
apply(put_on(red_pyramid,red_cube),18).
moves(18).
ok.

>>> 
>>> % WHICH CUBE IS SITTING ON THE TABLE?
>>> cube on.table?
--> show(B) :- cube(B), on(B,A), table(A).
green_cube_2.

>>> 
>>> % IS THERE A LARGE BLOCK BEHIND A PYRAMID?
>>> large block behind.pyramid?
--> show(B) :- large(B), block(B), behind(B,A), pyramid(A).
blue_block.
green_cube_1.

>>> 
>>> goal_once$on(red pyramid, green cube).
--> goal_once(on(A,B)) :- red(A), pyramid(A), green(B), cube(B).
apply(pickup(red_pyramid),19).
plan_interval(16,19,20).
apply(put_on(red_pyramid,green_cube_1),20).
moves(20).
ok.

>>> 
>>> % PUT A SMALL ONE ONTO THE GREEN CUBE WHICH SUPPORTS A PYRAMID.
>>> goal_once$on(small block, green cube supports.pyramid).
--> goal_once(on(A,C)) :- small(A), block(A), green(C), cube(C), supports(C,B), pyramid(B).
apply(pickup(blue_block),21).
apply(put_on(blue_block,green_cube_2),22).
apply(pickup(red_cube),23).
plan_interval(17,21,24).
apply(put_on(red_cube,green_cube_1),24).
moves(24).
ok.

>>> 
>>> % PUT THE LITTLEST PYRAMID ON TOP OF IT.
>>> goal_once$on(#most(little, pyramid), that).
--> goal_once(on(B,C)) :- little(B,A) : pyramid(A), B != A; pyramid(B), that(C).
apply(pickup(green_pyramid),25).
plan_interval(18,25,26).
apply(put_on(green_pyramid,red_cube),26).
moves(26).
ok.

>>> 
>>> % DOES THE SHORTEST THING THE TALLEST PYRAMID'S SUPPORT SUPPORTS SUPPORT ANYTHING GREEN?
>>> green on.#most(short, on.supports.#most(tall, pyramid))?
--> show(G) :- green(G), on(G,F), short(F,D) : superlative1(D), F != D; superlative1(F).
    superlative1(E) :- on(E,C), supports(C,B), tall(B,A) : pyramid(A), B != A; pyramid(B).
green_pyramid.

>>> 
>>> % WHAT COLOR IS IT?
>>> colour.supports.that?
--> show(C) :- colour(C,B), supports(B,A), that(A).
red.

>>> 
>>> % HOW MANY THINGS ARE ON TOP OF GREEN CUBES?
>>> above[green cube]?
--> show(B) :- above(B,A), green(A), cube(A).
blue_block.
red_cube.
red_pyramid.
green_pyramid.

>>> 
>>> % HAD YOU TOUCHED ANY PYRAMID BEFORE YOU PUT THE GREEN ONE ON THE LITTLE CUBE?
>>> pickup.pyramid before.goal.on(green pyramid, little cube)?
--> show(F) :- green(B), pyramid(B), little(C), cube(C), pickup(F,A), pyramid(A), end_time(G,F), G < H, start_time(H,E), goal(E,D), D = on(B,C).
apply(pickup(red_pyramid),19).
apply(pickup(red_pyramid),17).
apply(pickup(green_pyramid),13).
apply(pickup(blue_pyramid),5).
apply(pickup(blue_pyramid),11).

>>> 
>>> % WHEN DID YOU PICK IT UP?
>>> event during'.that?
--> show(B) :- event(B), start_time(C,A), end_time(D,A), start_time(E,B), end_time(F,B), E <= C, D <= F, A != B, that(A).
history(13,goal(stack(red_cube,big_red,red_pyramid))).
history(16,goal(on(red_pyramid,green_cube_1))).
history(3,goal(on(blue_block,box))).
history(4,goal(on(blue_pyramid,box))).

>>> 
>>> % WHY?
>>> why.that.2?
--> show(C) :- why(C,B), that(B,A), A = 2.
apply(put_on(green_pyramid,big_red),14).
apply(put_on(red_pyramid,red_cube),18).
apply(put_on(red_pyramid,green_cube_1),20).
apply(put_on(blue_pyramid,big_red),6).
apply(put_on(blue_pyramid,box),12).
apply(pickup(red_cube),15).

>>> 
>>> % WHY DID YOU DO THAT?
>>> why.that?
--> show(B) :- why(B,A), that(A).
goal(stack(red_cube,big_red,red_pyramid)).
apply(put_on(red_cube,big_red),16).
goal(on(red_pyramid,green_cube_1)).
apply(pickup(red_cube),15).
apply(pickup(red_pyramid),17).
apply(pickup(blue_block),7).
goal(on(blue_pyramid,box)).

>>> why.that?
--> show(B) :- why(B,A), that(A).
history(16,goal(on(red_pyramid,green_cube_1))).
apply(pickup(red_pyramid),17).
apply(put_on(red_cube,big_red),16).
history(13,goal(stack(red_cube,big_red,red_pyramid))).
history(4,goal(on(blue_pyramid,box))).
apply(put_on(red_pyramid,red_cube),18).
apply(put_on(blue_block,box),8).

>>> 
>>> % HOW DID YOU DO IT?
>>> event during.that?
--> show(B) :- event(B), start_time(C,B), end_time(D,B), start_time(E,A), end_time(F,A), E <= C, D <= F, B != A, that(A).
apply(put_on(red_pyramid,red_cube),18).
apply(put_on(red_cube,big_red),16).
apply(pickup(red_cube),15).
apply(put_on(green_pyramid,big_red),14).
apply(pickup(green_pyramid),13).
apply(pickup(red_pyramid),17).
apply(put_on(red_pyramid,green_cube_1),20).
apply(pickup(red_pyramid),19).
apply(put_on(blue_pyramid,box),12).
apply(pickup(blue_block),9).
apply(pickup(blue_pyramid),11).
apply(put_on(blue_block,green_cube_1),10).

>>> 
>>> % HOW MANY OBJECTS DID YOU TOUCH WHILE YOU WERE DOING IT?
>>> #count(pickup.object during.that.2)?
--> show(I) :- I = #count { D : pickup(D,A), object(A), start_time(J,D), end_time(K,D), start_time(L,C), end_time(M,C), L <= J, K <= M, D != C, that(C,B), B = 2 }.
6.

>>> 
>>> % WHAT DID THE RED CUBE SUPPORT BEFORE YOU STARTED TO CLEAN IT OFF?
>>> on[red cube; just_before.cleanoff[red cube]]?
--> show(E) :- on(C,E,D), end_time(F - 1,C), start_time(F,B), cleanoff(B,A), red(A), cube(A), red(D), cube(D).
red_pyramid.
green_pyramid.

>>> 
>>> % THERE WERE FIVE BLOCKS TO THE LEFT OF THE BOX THEN.
>>> block left_of[box; just_before.cleanoff[red cube]]?
--> show(E) :- block(E), left_of(C,E,D), end_time(F - 1,C), start_time(F,B), cleanoff(B,A), red(A), cube(A), box(D).
red_cube.

>>> #count(that)?
--> show(B) :- B = #count { A : that(A) }.
1.

>>> 
>>> goal_once$on(blue block, box).
--> goal_once(on(A,B)) :- blue(A), block(A), box(B).
apply(pickup(blue_pyramid),27).
apply(put_on(blue_pyramid,table_back_left),28).
apply(pickup(blue_block),29).
plan_interval(32,27,30).
apply(put_on(blue_block,box),30).
moves(30).
ok.

>>> 
>>> % PUT THE BLUE PYRAMID ON THE BLOCK IN THE BOX.
>>> goal_once$on(blue pyramid, block above.box).
--> goal_once(on(A,C)) :- blue(A), pyramid(A), block(C), above(C,B), box(B).
apply(pickup(blue_pyramid),31).
plan_interval(33,31,32).
apply(put_on(blue_pyramid,blue_block),32).
moves(32).
ok.

>>> 
>>> % IS THERE ANYTHING WHICH IS BIGGER THAN EVERY PYRAMID BUT IS NOT AS WIDE AS THE THING THAT SUPPORTS IT?
>>> object #each(big, pyramid) X wide'.supports.X?
--> show(D) :- object(D), big(D,A) : pyramid(A); D = MuX, wide(C,D), supports(C,B), B = MuX.
blue_block.

>>> 
>>> % A "STEEPLE" IS A STACK WHICH CONTAINS TWO GREEN CUBES AND A PYRAMID.
>>> :def steeple$stack(green cube, green cube, pyramid).
--> :def steeple(stack(A,B,C)) :- green(A), cube(A), green(B), cube(B), pyramid(C).
understood.

>>> 
>>> % ARE THERE ANY STEEPLES NOW?
>>> #any(steeple holds.now)?
--> show(C) :- any1(C).
    any1(true) :- steeple(B), holds(B,A), now(A).
    any1(false) :- not any1(true).
false.

>>> 
>>> % BUILD ONE.
>>> goal_once(steeple).
--> goal_once(A) :- steeple(A).
apply(pickup(red_pyramid),33).
apply(put_on(red_pyramid,blue_block),34).
apply(pickup(green_pyramid),35).
apply(put_on(green_pyramid,table_front_left),36).
apply(pickup(red_cube),37).
apply(put_on(red_cube,table_front_left),38).
apply(pickup(green_cube_2),39).
apply(put_on(green_cube_2,green_cube_1),40).
apply(pickup(red_pyramid),41).
plan_interval(36,33,42).
apply(put_on(red_pyramid,green_cube_2),42).
moves(42).
ok.

>>> 
>>> % CALL THE BIGGEST BLOCK "SUPERBLOCK".
>>> :def superblock(#most(big, block)).
--> :def superblock(B) :- big(B,A) : block(A), B != A; block(B).
understood.

>>> 
>>> % HAVE YOU PICKED SUPERBLOCK UP SINCE WE BEGAN?
>>> #any(superblock picked_up)?
--> show(B) :- any1(B).
    any1(true) :- superblock(A), picked_up(A).
    any1(false) :- not any1(true).
true.

>>> 
>>> % WHY DID YOU DROP IT?
>>> why.put_on(superblock, table)?
--> show(D) :- superblock(A), table(B), why(D,C), C = put_on(A,B).
nonexistent.

>>> 
>>> goal_once$left_of(red pyramid, box).
--> goal_once(left_of(A,B)) :- red(A), pyramid(A), box(B).
apply(pickup(red_pyramid),43).
plan_interval(39,43,44).
apply(put_on(red_pyramid,table_back_left),44).
moves(44).
ok.

>>> 
>>> % IS THERE ANYTHING TO THE RIGHT OF THE RED PYRAMID?
>>> right_of[red pyramid]?
--> show(B) :- right_of(B,A), red(A), pyramid(A).
box.
big_red.
blue_block.
green_cube_1.
green_cube_2.
blue_pyramid.

>>> 
>>> thanks.
YOU'RE WELCOME!
