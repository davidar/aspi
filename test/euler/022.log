>>> % 22. What is the total of all the name scores in the file of first names? 
>>> 
>>> #macro char.S: substring[S, 1..length.S, 1].
--> char(C,MuS) :- C = @substring(MuS,B,1), B = 1 .. A, A = @length(MuS).
understood.

>>> #macro letter.C: (codepoint.C - codepoint."A") + 1.
--> letter((A-B)+1,MuC) :- A = @codepoint(MuC), B = @codepoint("A").
understood.

>>> 
>>> name: csv[1, 1..1000].
--> name(B) :- csv(B,1,A), A = 1 .. 1000.
understood.

>>> position[name S]: N: S = N'th.{name}.
--> position(MuN,A) :- name(A), A = MuS, MuS = E, B = MuN, (B,E) = @enumerateof(D), setof((1),D).
    gather((1),C) :- name(C).
understood.

>>> value[name S]: sum{{letter.char.S}}.
--> value(N,A) :- name(A), A = MuS, N = @sumof(M), bagof((2,MuS),M).
    aggregation((1,MuS),I) :- I = (J - K) + 1, J = @codepoint(D), K = @codepoint("A"), D = @substring(MuS,E,1), E = 1 .. F, F = @length(MuS), name(A), A = MuS.
    gather((2,MuS),(L,P0)) :- proof(P0,aggregation((1,MuS),L)), name(A), A = MuS.
understood.

>>> score[name S]: position.S * value.S.
--> score(B*C,A) :- name(A), A = MuS, position(B,MuS), value(C,MuS).
understood.

>>> sum{{score.name}}?
--> what(E) :- E = @sumof(D), bagof((3),D).
    aggregation((2),B) :- score(B,A), name(A).
    gather((3),(C,P0)) :- proof(P0,aggregation((2),C)).
that: 31683477.

>>> thanks.
YOU'RE WELCOME!
